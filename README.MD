# Automatic Chemistry Descriptors for organic molecules and materials

From a chemist’s standpoint, AutoChemDescriptors is the missing bridge between raw SMILES molecular representation and ready-to-interpret chemical insight. It translates molecular strings into quantitative descriptors, optionally optimizes geometries quantum-mechanically, and produces exploratory analyses that reveal similarities, trends, and outliers across organic molecules and materials—all without micromanaging multiple standalone tools.

## Capabilities at a glance
- (1) SMILES molecular codes as inputs to obtain, from RDKit, molecular descriptors;
- (2) from SMILES codes, the molecules coordinates are generated (by RDKit) and PySCF is used to localy optimize them (by DFT) in order to obtain the Many Body Tensor Representation (MBTR) or Smooth Overlap of Atomic Positions (SOAP) descriptors;
- (3) also from SMILES representations, electronic strucutre properties descriptors from quantum chemistry (QC) calculations -- i.e. total energy, hardness, electronegativity, HOMO and LUMO energy, band-gap and XYZ dipole moment -- are generated by PySCF;
- (4) molecular structures from XYZ can be used as input in order to obtain MBTR, SOAP and QC descriptors.
- (5) Scale calculations across as many processes (`n_jobs`) as your workstation allows, accelerating quantum chemistry calculations (i.e. PySCF) by parallelism.
- (6) Obtain unsupervised mahcine learning -- i.e. PCA-based grouping, heatmap, and biplot -- visualizations immediately after descriptor generation.
- (7) Keep audit-ready records (molecule depictions, XYZ snapshots, software versions, execution times) for reproducibility and reporting.

(1) SMILES molecular codes as inputs to obtain, from RDKit, molecular descriptors;
(2) from SMILES codes, the molecules coordinates are generated (by RDKit) and PySCF is used to localy optimize them (by DFT) in order to obtain the Many Body Tensor Representation (MBTR) or Smooth Overlap of Atomic Positions (SOAP) descriptors;
(3) also from SMILES representations, electronic strucutre properties descriptors from quantum chemistry (QC) calculations -- i.e. total energy, hardness, electronegativity, HOMO and LUMO energy, band-gap and XYZ dipole moment -- are generated by PySCF;
(4) molecular structures from XYZ can be used as input in order to obtain MBTR, SOAP and QC descriptors.
(5) Scale calculations across as many processes (n_jobs) as your workstation allows, accelerating quantum chemistry calculations (i.e. PySCF) by parallelism.
(6) Obtain unsupervised mahcine learning -- i.e. PCA-based grouping, heatmap, and biplot -- visualizations immediately after descriptor generation.
(7) Keep audit-ready records (molecule depictions, XYZ snapshots, software versions, execution times) for reproducibility and reporting.
(8) Clustering analysis and plots by KMeans and DBSCAN methods. 

## Before you begin
1. Set up a Python 3 environment and install the packages listed in `requirements.txt` (RDKit, PySCF, DScribe, ASE, NumPy, SciPy, Matplotlib, scikit-learn, Torch, PyBERNY).
2. Place the `auto_chem_descriptors` package somewhere in your project workspace. You are free to organize your runs in separate folders; this guide does not rely on the bundled `examples` directory.

## Preparing your run script
Create a working directory (for instance, `~/chem_runs/run001`) and inside it create a file named `autochemdesc.py` with the following structure. All parameters—descriptor type, molecule list, calculator settings, PCA configuration, number of jobs, debug flag—are user-editable, but keep the structural skeleton intact.

```python
from main_auto_chem_descriptor import main_auto_chem_descriptor

if __name__ == '__main__':

    is_debug_true = False

    n_jobs = 2

    input_flow_controller = {
            'molecular_encoding': "SMILES",
            'descriptors_type': "SMILES",
    }

    molecules_coded_list = [
                 "COc1ccccc1O",
                 "COc1ccccc1OCC(=O)O",
                 "COc1ccccc1OCC(=O)Nc1ccccc1",
                 "COc1ccccc1OCC(=O)Nc1ccccc1F",
                 "COc1ccccc1OCC(=O)Nc1cccc(F)c1",
                 "COc1ccccc1OCC(=O)Nc1ccc(F)cc1",
                 "COc1ccccc1OCC(=O)Nc1cccc2ccccc12",
                ]

    calculator_controller = {}

    n_components = 4

    analysis = {

        "pca_heatmap": [True, n_components],
        "pca_grouping": [True, n_components],
        "pca_dispersion": [True, n_components],

        "molecules_color": ['b', 'g', 'r', 'c', 'm', 'b', 'g', 'r', 'c', 'm', 'y',
                            'b', 'g', 'r', 'c', 'm', 'b', 'g', 'r', 'c', 'm', 'y'],

        "molecules_label": [
          'Guaiacol', 'GACO1', 'GAO00', 'GAA21',
          'GAA31', 'GAA41', 'GAA22']
     }

    main_auto_chem_descriptor(n_jobs,
                              input_flow_controller,
                              molecules_coded_list,
                              calculator_controller,
                              analysis)
```

Feel free to switch `descriptors_type` to `"MBTR"` or `"SOAP"` or `"QC"` (quantum chemistry), add basis-set parameters to `calculator_controller`, or tailor the PCA options; the structure remains identical, and every field is configurable.

## Running the workflow
Inside the directory that contains `autochemdesc.py`, point `PYTHONPATH` to wherever `auto_chem_descriptors` resides and execute the script. Example session (path names are illustrative):

```
(venv) user@labhost ~/chem_runs/run001 $ PYTHONPATH="../auto_chem_descriptors" python autochemdesc.py
```

The program will report descriptor values, save any requested PNG/XYZ/PCA files, print software version info, and summarize the elapsed time.

## Interpreting the outputs
- **Descriptor arrays** (RDKit or MBTR) can be consumed by clustering, QSAR, or active-learning pipelines.
- **Molecule images and XYZ snapshots** help trace any data point back to its structure or geometry optimization stage.
- **PCA figures** visualize grouping tendencies, feature importances, and dominant directions of variance, providing immediate insight into the sampled chemical space.
- **Console logs** register library versions and execution timestamps for reproducibility.

## Support and citation
AutoChemDescriptors was created by Maicon P. Lourenço and Clayton V. F. Filho (from GAMIAC research group at the Federal University of Espírito Santo, in Alegre, Brazil). This research is done in collaboration with Dennis R. Salahub (University of Calgary), Jiri Hostas (NRC Canada), Hélio Anderson Duarte and Ângelo de Fátima from Federal University of Mians Gerais. Undergrad students from UFES involved: Stephano Dorigo Scaramussa and Alehando Lopes Gamas. Acknowledgements: REDNIU INCT, FAPES, CNPQ, CAPES. Please, cite the references printed by `software_information_auto_chem_descriptors` in any publication using these workflows. For scientific or technical inquiries, reach out via maiconpl01@gmail.com.***
